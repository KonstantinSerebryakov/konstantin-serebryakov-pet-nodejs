function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P(t,e,n){g(t,e),e.set(t,n)}function g(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(t,e){var n=y(t,e,"get");return L(t,n)}function L(t,e){return e.get?e.get.call(t):e.value}function w(t,e,n){var i=y(t,e,"set");return _(t,i,n),n}function y(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var T=typeof Symbol!="undefined"?Symbol.toStringTag:"@@toStringTag",a=new WeakMap,l=new WeakMap;class f{constructor(e){var{executor:n=()=>{},internals:i=v(),promise:S=new Promise((C,d)=>n(C,d,p=>{i.onCancelList.push(p)}))}=e;P(this,a,{writable:!0,value:void 0}),P(this,l,{writable:!0,value:void 0}),s(this,T,"CancelablePromise"),this.cancel=this.cancel.bind(this),w(this,a,i),w(this,l,S||new Promise((C,d)=>n(C,d,p=>{i.onCancelList.push(p)})))}then(e,n){return u(r(this,l).then(o(e,r(this,a)),o(n,r(this,a))),r(this,a))}catch(e){return u(r(this,l).catch(o(e,r(this,a))),r(this,a))}finally(e,n){return n&&r(this,a).onCancelList.push(e),u(r(this,l).finally(o(()=>{if(e)return n&&(r(this,a).onCancelList=r(this,a).onCancelList.filter(i=>i!==e)),e()},r(this,a))),r(this,a))}cancel(){r(this,a).isCanceled=!0;var e=r(this,a).onCancelList;r(this,a).onCancelList=[];for(var n of e)if(typeof n=="function")try{n()}catch(i){console.error(i)}}isCanceled(){return r(this,a).isCanceled===!0}}class c extends f{constructor(e){super({executor:e})}}s(c,"all",function(e){return h(e,Promise.all(e))});s(c,"allSettled",function(e){return h(e,Promise.allSettled(e))});s(c,"any",function(e){return h(e,Promise.any(e))});s(c,"race",function(e){return h(e,Promise.race(e))});s(c,"resolve",function(e){return b(Promise.resolve(e))});s(c,"reject",function(e){return b(Promise.reject(e))});s(c,"isCancelable",m);function b(t){return u(t,v())}function m(t){return t instanceof c||t instanceof f}function o(t,e){if(t)return n=>{if(!e.isCanceled){var i=t(n);return m(i)&&e.onCancelList.push(i.cancel),i}return n}}function u(t,e){return new f({internals:e,promise:t})}function h(t,e){var n=v();return n.onCancelList.push(()=>{for(var i of t)m(i)&&i.cancel()}),new f({internals:n,promise:e})}function v(){return{isCanceled:!1,onCancelList:[]}}export{c as C};
